<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Monitoring Dashboard{% endblock %}</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!-- Poprawione ścieżki do stylów -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/loading.css') }}">
    {% block head %}{% endblock %}
    <!-- Theme styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/theme-light.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/theme-dark.css') }}">
    <script src="{{ url_for('static', filename='js/charts.js') }}"></script>
</head>
<body class="with-sidebar">
    <!-- Top Navigation -->
    <nav class="top-nav">
        <div class="nav-brand">
            <i class="fas fa-chart-line"></i>
            Monitoring System
        </div>
        {% if session.logged_in %}
        <div class="nav-items">
            <button id="theme-toggle" class="theme-toggle" title="Toggle theme">
                <i class="fas fa-sun"></i>
            </button>
            <a href="{{ url_for('profile') }}" class="user-info">
                {% if session.user_info and session.user_info.avatar_path %}
                    <img src="{{ url_for('static', filename='avatars/' + session.user_info.avatar_path) }}?v={{ time.time() }}" alt="Profile" class="nav-avatar">
                {% else %}
                    <div class="nav-avatar-placeholder">
                        <i class="fas fa-user-circle"></i>
                    </div>
                {% endif %}
                <span class="nav-username">{{ session.user_info.display_name if session.user_info.display_name else session.username }}</span>
            </a>
            <a href="{{ url_for('logout') }}" class="logout-button">
                <i class="fas fa-sign-out-alt"></i>
                Wyloguj
            </a>
        </div>
        {% endif %}
    </nav>

    <!-- Side Navigation -->
    <nav class="side-nav">
        <div class="nav-section">
            <h3>Main Menu</h3>
            <a href="/" class="nav-link {% if request.path == '/' %}active{% endif %}">
                <i class="fas fa-home"></i> Dashboard
            </a>
        </div>
        
        <div class="nav-section">
            <h3>Zabbix</h3>
            <a href="/available-hosts" class="nav-link available {% if request.path == '/available-hosts' %}active{% endif %}">
                <i class="fas fa-check-circle"></i> Available
            </a>
            <a href="/unavailable-hosts" class="nav-link unavailable {% if request.path == '/unavailable-hosts' %}active{% endif %}">
                <i class="fas fa-times-circle"></i> Unavailable
            </a>
            <a href="/unknown-hosts" class="nav-link unknown {% if request.path == '/unknown-hosts' %}active{% endif %}">
                <i class="fas fa-question-circle"></i> Unknown
            </a>
        </div>
        
        <div class="nav-section">
            <h3>Tools</h3>
            <a href="/reports" class="nav-link {% if request.path == '/reports' %}active{% endif %}">
                <i class="fas fa-file-alt"></i> Reports
            </a>
        </div>

        <div class="nav-section">
            <h3>Functions</h3>
            <a href="/inventory" class="nav-link {% if request.path == '/inventory' %}active{% endif %}">
                <i class="fas fa-boxes"></i> Item Inventory
            </a>
            <a href="/tasks" class="nav-link {% if request.path == '/tasks' %}active{% endif %}">
                <i class="fas fa-tasks"></i> Task Management
            </a>
        </div>

        <div class="nav-section">
            <h3>GLPI Inventory</h3>
            <a href="/glpi/workstations" class="nav-link {% if request.path == '/glpi/workstations' %}active{% endif %}">
                <i class="fas fa-desktop"></i> Workstations (KS)
            </a>
            <a href="/glpi/terminals" class="nav-link {% if request.path == '/glpi/terminals' %}active{% endif %}">
                <i class="fas fa-terminal"></i> Terminals (KT)
            </a>
            <a href="/glpi/servers" class="nav-link {% if request.path == '/glpi/servers' %}active{% endif %}">
                <i class="fas fa-server"></i> Servers
            </a>
            <a href="/glpi/network" class="nav-link {% if request.path == '/glpi/network' %}active{% endif %}">
                <i class="fas fa-network-wired"></i> Network Devices
            </a>
            <a href="/glpi/printers" class="nav-link {% if request.path == '/glpi/printers' %}active{% endif %}">
                <i class="fas fa-print"></i> Printers
            </a>
            <a href="/glpi/monitors" class="nav-link {% if request.path == '/glpi/monitors' %}active{% endif %}">
                <i class="fas fa-tv"></i> Monitors
            </a>
            <a href="/glpi/racks" class="nav-link {% if request.path == '/glpi/racks' %}active{% endif %}">
                <i class="fas fa-server"></i> Racks
            </a>
            <a href="/glpi/others" class="nav-link {% if request.path == '/glpi/others' %}active{% endif %}">
                <i class="fas fa-microchip"></i> Other Devices
            </a>
        </div>

        <div class="nav-section">
            <h3>Graylog</h3>
            <a href="/graylog/logs?refresh=1" class="nav-link {% if request.path == '/graylog/logs' %}active{% endif %}">
                <i class="fas fa-history"></i> Recent Logs
            </a>
            <a href="/graylog/loading?target=/graylog/messages-over-time" class="nav-link {% if request.path == '/graylog/messages-over-time' %}active{% endif %}">
                <i class="fas fa-chart-line"></i> Messages Over Time
            </a>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="main-footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>Monitoring System</h4>
                <p>Version 1.0.0</p>
            </div>
            <div class="footer-section">
                <h4>Quick Links</h4>
                <a href="#">Documentation</a>
                <a href="#">Support</a>
            </div>
            <div class="footer-section">
                <h4>Contact</h4>
                <p>bartosz.dutka82@student.pk.edu.pl</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 Monitoring System. All rights reserved.</p>
        </div>
    </footer>
    
    <script>
document.addEventListener('DOMContentLoaded', () => {
    const themeToggle = document.getElementById('theme-toggle');
    const icon = themeToggle.querySelector('i');
    const html = document.documentElement;
    
    // Funkcja do aktualizacji motywu
    function updateTheme(isDark) {
        const theme = isDark ? 'dark' : 'light';
        html.setAttribute('data-theme', theme);
        document.body.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        
        // Aktualizuj ikonę
        icon.className = isDark ? 'fas fa-sun' : 'fas fa-moon';
        icon.style.color = isDark ? '#e0e0e0' : '#2ecc71';
        
        // Wymuś przeliczenie stylów
        document.body.style.display = 'none';
        document.body.offsetHeight; // Force reflow
        document.body.style.display = '';
    }
    
    // Inicjalizacja przy załadowaniu
    const savedTheme = localStorage.getItem('theme') || 'light';
    updateTheme(savedTheme === 'dark');
    
    // Obsługa kliknięcia
    themeToggle.addEventListener('click', () => {
        const isDark = html.getAttribute('data-theme') === 'dark';
        updateTheme(!isDark);
    });
});
</script>
</body>
</html>