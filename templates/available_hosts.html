{% extends "layout.html" %}

{% block content %}
<div class="dashboard-header">
    <h1>Available Hosts</h1>
</div>

<div class="dashboard-grid">
    <div class="dashboard-card navigation-card">
        <div class="card-content">
            <nav class="dashboard-nav horizontal">
                <a href="/" class="dashboard-nav-link">
                    <i class="fas fa-home"></i>
                    <span>Dashboard</span>
                </a>
                <a href="/available-hosts" class="dashboard-nav-link available active">
                    <i class="fas fa-check-circle"></i>
                    <span>Available</span>
                </a>
                <a href="/unavailable-hosts" class="dashboard-nav-link unavailable">
                    <i class="fas fa-times-circle"></i>
                    <span>Unavailable</span>
                </a>
                <a href="/unknown-hosts" class="dashboard-nav-link unknown">
                    <i class="fas fa-question-circle"></i>
                    <span>Unknown</span>
                </a>
            </nav>
        </div>
    </div>

    <div class="dashboard-card full-width">
        <div class="card-header">
            <i class="fas fa-server"></i>
            <h2>Host Status</h2>
            <div class="header-actions">
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="host-search" placeholder="Search available hosts...">
                </div>
            </div>
        </div>
        <div class="card-content">
            <div class="hosts-container" id="available-hosts">
                <!-- Data will be dynamically inserted here -->
            </div>
        </div>
    </div>
</div>

<!-- Add this JavaScript block at the end of your content block -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Example of rendering a host with the new structure and alerts
    function renderHost(host) {
        return `
        <div class="host-card available">
            <h3><i class="fas fa-server"></i>${host.name}</h3>
            
            <div class="status-badge online">
                <i class="fas fa-circle"></i>
                <span>Online</span>
            </div>
            
            <div class="device-details">
                <div class="detail-item">
                    <i class="fas fa-network-wired"></i>
                    <div class="detail-content">
                        <span class="detail-label">IP Address</span>
                        <span class="detail-value">${host.ip}</span>
                    </div>
                </div>
                
                <div class="detail-item">
                    <i class="fas fa-microchip"></i>
                    <div class="detail-content">
                        <span class="detail-label">System</span>
                        <span class="detail-value">${host.os || 'Unknown'}</span>
                    </div>
                </div>
                
                <div class="detail-item">
                    <i class="fas fa-clock"></i>
                    <div class="detail-content">
                        <span class="detail-label">Uptime</span>
                        <span class="detail-value">${host.uptime || 'N/A'}</span>
                    </div>
                </div>
                
                ${renderAlerts(host.alerts)}
            </div>
            
            <div class="device-actions">
                <a href="#" class="action-button">
                    <i class="fas fa-info-circle"></i>
                    <span>Details</span>
                </a>
                <a href="${host.vnc_url}" class="vnc-button">
                    <i class="fas fa-desktop"></i>
                    <span>Connect</span>
                </a>
            </div>
        </div>
        `;
    }
    
    // Render alerts in a scrollable container
    function renderAlerts(alerts) {
        if (!alerts || alerts.length === 0) return '';
        
        const alertsHtml = alerts.map(alert => `
            <div class="alert-item ${alert.level || 'info'}">
                <div class="alert-icon">
                    <i class="fas ${getAlertIcon(alert.level)}"></i>
                </div>
                <div class="alert-content">
                    <div class="alert-title">${alert.title}</div>
                    <div class="alert-message">${alert.message}</div>
                    <div class="alert-time">${alert.time}</div>
                </div>
            </div>
        `).join('');
        
        return `
            <div class="alert-container">
                ${alertsHtml}
            </div>
        `;
    }
    
    // Get the appropriate icon for alert level
    function getAlertIcon(level) {
        switch(level) {
            case 'critical':
                return 'fa-exclamation-circle';
            case 'warning':
                return 'fa-exclamation-triangle';
            default:
                return 'fa-info-circle';
        }
    }

    // Your existing code to fetch and render hosts
    // Then use this rendering function for each host
});
</script>

{% endblock %}
